<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-research/other/collision-effects" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">2025-02-07 Material collision effects and breakable objects | Haï~</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.hai-vr.dev/img/hai-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.hai-vr.dev/img/hai-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.hai-vr.dev/docs/research/other/collision-effects"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2025-02-07 Material collision effects and breakable objects | Haï~"><meta data-rh="true" name="description" content="I was building a new home world after being bored by the one that I had been using for over a year."><meta data-rh="true" property="og:description" content="I was building a new home world after being bored by the one that I had been using for over a year."><meta data-rh="true" name="robots" content="noindex, nofollow"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.hai-vr.dev/docs/research/other/collision-effects"><link data-rh="true" rel="alternate" href="https://docs.hai-vr.dev/docs/research/other/collision-effects" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.hai-vr.dev/docs/research/other/collision-effects" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/updates/rss.xml" title="Haï~ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/updates/atom.xml" title="Haï~ Atom Feed">





<script src="https://plausible.io/js/script.js" defer="defer" data-domain="docs.hai-vr.dev"></script><link rel="stylesheet" href="/assets/css/styles.5e90e6fe.css">
<script src="/assets/js/runtime~main.22ab5e41.js" defer="defer"></script>
<script src="/assets/js/main.df132256.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/hai-avi.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/hai-avi.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Haï~</b></a><a class="navbar__item navbar__link" href="/docs/products">Products</a><a class="navbar__item navbar__link" href="/docs/resilience">ResilienceVR</a><a class="navbar__item navbar__link" href="/updates">Updates</a><a class="navbar__item navbar__link" href="/docs/changelogs">Changelogs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/research">Research</a><a class="navbar__item navbar__link" href="/docs/other/discord">Help &amp; Discord</a><a class="navbar__item navbar__link" href="/docs/other/patreon">Patreon rewards</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item"><a href="https://bsky.app/profile/just.hai-vr.dev" rel="noopener noreferrer"><img src="/img/media/bluesky.png" alt="just.hai-vr.dev"></a></div><a href="https://www.patreon.com/vr_hai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Patreon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/hai-vr/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research">Research</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/research/toe-tracking">Multi-Toe Tracking</a><button aria-label="Expand sidebar category &#x27;Multi-Toe Tracking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research/nochat">Nochat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/research/articles">Other articles</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/research/other/modular-avatar-on-other-apps-ja">Other</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/research/other/collision-effects">2025-02-07 Material collision effects and breakable objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research/other/modular-avatar-on-other-apps-ja">2024-12-08 他のアプリケーションでModular Avatarを動かす方法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research/other/modular-avatar-on-other-apps">2024-12-08 Running Modular Avatar on other apps</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning theme-unlisted-banner"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Unlisted page</div><div class="admonitionContent_BuS1">This page is unlisted. Search engines will not index it, and only users having a direct link can access it.</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Other</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">2025-02-07 Material collision effects and breakable objects</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>2025-02-07 Material collision effects and breakable objects</h1>
<p>I was building a new home world after being bored by the one that I had been using for over a year.</p>
<p>Initially, I just wanted to make sure that shooting walls would produce decals and the correct sound effects depending on the material being hit
because of a <a href="https://www.youtube.com/watch?v=TbZ3HzvFEto&amp;t=908s" target="_blank" rel="noopener noreferrer">Half-Life 1 documentary starring Gabe Newell on the topic of fun and world interactivity (2-minute watch, between 15:08-17:03)</a>,
but the whole idea went out of control and I ended up building an analogue of throwable and breakable objects.</p>
<p>Below is a random assortment of things I have learned while building this system.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="continuous-speculative-outputs-0-newton-collisions">Continuous Speculative outputs 0 newton collisions<a href="#continuous-speculative-outputs-0-newton-collisions" class="hash-link" aria-label="Direct link to Continuous Speculative outputs 0 newton collisions" title="Direct link to Continuous Speculative outputs 0 newton collisions">​</a></h2>
<p>When a rigidbody is thrown and hits another collider, a <code>OnCollisionEnter</code> event will be raised, containing information about the collision.
In order to apply an appropriate sound effect volume and damage amount, we need to read the collision force.</p>
<p>The issue is that depending on the collision type of the rigidbody, the reported amount may equal to <strong>0 newton</strong>.
This especially happens when the rigidbody is set to <em>Continuous Speculative</em>.</p>
<p>The fix is to set the collision type to <em>Continuous Dynamic</em>, as long as we care about these objects reporting the correct forces to produce sounds or be damaged on impact.
For instance, this is not necessary on the individual debris emitted out of breakable objects.</p>
<p><span><div class="hai_tag_ZcC4 hai_tag_requires_vrchat_kYpu">💬 <!-- -->VRChat</div></span> A <a href="https://x.com/MMMaellon/status/1732068213780103650" target="_blank" rel="noopener noreferrer">tweet also suggests that</a> objects with VRCObjectSync <em>&quot;forces your rigid bodies to continuous speculative&quot;</em>,
so you may need to force the collision type to be <em>Continuous Dynamic</em> through an Udon script.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="if-a-thrown-object-breaks-another-open-it-should-not-bounce-away">If a thrown object breaks another open, it should not bounce away<a href="#if-a-thrown-object-breaks-another-open-it-should-not-bounce-away" class="hash-link" aria-label="Direct link to If a thrown object breaks another open, it should not bounce away" title="Direct link to If a thrown object breaks another open, it should not bounce away">​</a></h2>
<p>If you throw a bowling ball against a fragile window, the bowling ball should go through the window because it conserves most of its energy.</p>
<p>The issue is that collisions with all non-moving objects will cause the thrown object to bounce away from it.
This also applies to some heavy breakable objects that can be moved.</p>
<p>The fix that I chose is to save the velocity and angular velocity of thrown objects every physics frame in <code>FixedUpdate</code>.
When an object breaks apart, it needs to inform the other object that collided with it, so that it cancels the bounce and re-applies most of
its energy based on the velocity and angular velocity of the last saved physics frame.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-material-hit-in-a-multi-material-mesh">Getting the material hit in a multi-material mesh<a href="#getting-the-material-hit-in-a-multi-material-mesh" class="hash-link" aria-label="Direct link to Getting the material hit in a multi-material mesh" title="Direct link to Getting the material hit in a multi-material mesh">​</a></h2>
<p>If an environment mesh/world mesh is made out of multiple materials, hitting it with bullets or collisions should
produce different sounds based on what that material represents, for example if it&#x27;s glass.</p>
<p>This information can be encoded in the Physics Material type of the collider, but there is another approach.</p>
<p>When a mesh has multiple materials, <strong>it is possible</strong> to use Mesh Colliders with raycasts to get the material that is hit.
(Whether you should use this approach is a different question)</p>
<p>To do this, raycasts will report a triangle index if a Mesh Collider has been hit by the raycast.</p>
<p>To convert the triangle index to a material, you need to get the mesh asset of that Mesh Collider, and for each sub-mesh of that mesh,
use <code>triangleCount[subMeshIndex] = mesh.GetSubMesh(subMeshIndex).indexCount / 3;</code> to get the number of triangles for that sub-mesh (notice how we divide by three).</p>
<p>If a mesh has 3 sub-meshes, and their triangle count are <code>70, 50, 40</code> in that order, then a triangle index of 74 will mean you hit the sub-mesh at index 1 (which is the second one),
so you can get the material slot at index 1. A triangle index of 122 would be index 2, because it is greater or equal to <code>70 + 50</code>.</p>
<p><span><div class="hai_tag_ZcC4 hai_tag_requires_vrchat_kYpu">💬 <!-- -->VRChat</div></span> Submesh data is not accessible with Udon, so you need to bake this data in Edit mode however you like.</p>
<p><span><div class="hai_tag_ZcC4 hai_tag_requires_vrchat_kYpu">💬 <!-- -->VRChat</div></span> Batching will cause issues with this technique as you <em>might</em> not be able to bake the triangle data.</p>
<p>Again, whether you should use this technique over splitting into different meshes, or using different colliders for each material, is a different question.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="manual-sync-arrives-way-sooner-than-ikvrcobjectsync">Manual Sync arrives way sooner than IK/VRCObjectSync<a href="#manual-sync-arrives-way-sooner-than-ikvrcobjectsync" class="hash-link" aria-label="Direct link to Manual Sync arrives way sooner than IK/VRCObjectSync" title="Direct link to Manual Sync arrives way sooner than IK/VRCObjectSync">​</a></h2>
<div><p><span><div class="hai_tag_ZcC4 hai_tag_requires_vrchat_kYpu">💬 <!-- -->VRChat</div></span></p></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-player-pools-to-send-and-receive-packets-player-objects">Using Player pools to send and receive packets (Player Objects)<a href="#using-player-pools-to-send-and-receive-packets-player-objects" class="hash-link" aria-label="Direct link to Using Player pools to send and receive packets (Player Objects)" title="Direct link to Using Player pools to send and receive packets (Player Objects)">​</a></h3>
<p>When an object breaks apart, this information arrives through Manual Sync information which is located outside the VRCObjectSync hierarchy.</p>
<p>The way I have designed the damage networking in my world is through the use of many player pools (now known as Player Objects, in this case non-persistent ones).</p>
<ul>
<li>Each player gets their own set of Manual Sync for each specialized <em>&quot;packet&quot;</em> it needs to send.</li>
<li>To damage an object, players would submit a packet containing all the individual pieces of damage instances this player has dealt since last serialization.</li>
<li>Everyone receives that packet and applies the damage.</li>
<li>The default network owner (also known as master) would track the actual health of these objects, and makes sure everyone else agrees on the actual health of the object.</li>
</ul>
<p><strong>Each player individually tracks the health of those objects locally.</strong> This has the advantage of:</p>
<ul>
<li>avoiding ownership transfers altogether, letting multiple players damage the same object simultaneously,</li>
<li>it also avoids a round-trip between the person dealing the damage, and the default network owner confirming that the damage has been dealt,</li>
<li>if the local player performs an action that breaks the object, it breaks instantly <strong>without waiting for any response from the network</strong>.</li>
</ul>
<p>As a consequence, the objects break as soon as the message is received, and if the local player breaks the object, it also breaks locally with no delay, even if they do not own the object itself,
making for a very responsive system that emphasizes visual effects over correctness and proper damage attribution.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="damage-packets-arrive-too-soon-before-the-visual-cause-of-damage-happens">Damage packets arrive too soon, before the visual cause of damage happens<a href="#damage-packets-arrive-too-soon-before-the-visual-cause-of-damage-happens" class="hash-link" aria-label="Direct link to Damage packets arrive too soon, before the visual cause of damage happens" title="Direct link to Damage packets arrive too soon, before the visual cause of damage happens">​</a></h3>
<p>This works great with damage coming from bullets.</p>
<p>However, this causes a major problem: Damage caused by collisions with walls are always transmitted by the network owner of the rigidbody itself,
but the damage packets from this collision often arrive to other players before the object is even close to hitting the walls.</p>
<p>This causes objects to break in midair, or worse, break before they are even thrown.</p>
<p>The solution I chose to fix this is to create a 2nd specialized damage packet, dedicated to collisions with walls. The network owner of the rigidbody
will sumbit those specialized damage packets, containing the position of the rigidbody when it collides with anything.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-objects-from-collisions-are-intentionally-delayed">Breaking objects from collisions are intentionally delayed<a href="#breaking-objects-from-collisions-are-intentionally-delayed" class="hash-link" aria-label="Direct link to Breaking objects from collisions are intentionally delayed" title="Direct link to Breaking objects from collisions are intentionally delayed">​</a></h3>
<p>On other clients, if receiving that specialized damage packet would have resulted in the health going from non-zero value to zero, then the breaking visual effect
would be <strong>intentionally delayed</strong> until either of the following happens:</p>
<ul>
<li>The rigidbody position reaches the position indicated within that specialized packet, or</li>
<li>A maximum time limit of 1 second since receiving that packet is reached, or</li>
<li>The object ends up damaged by any other reason than a collision, such as a bullet hitting it.</li>
</ul>
<p>There are edges cases to this approach, for instance if the object breaks from a collision, but not as a result of itself being thrown,
but as a result of another object being thrown into it. This is still something I may have to fix.</p>
<p>In addition, <strong>this approach is really sensitive to deserialization order</strong>, which is a flaw. In particular, the default network owner will submit updates
about the actual health of the objects so that other players may try to resync in case of a disagreement on the health of the object.</p>
<p>There is a special case when the default network owner declares that the health went from non-zero to zero,
causing the object to break instantly if it was not already broken by a damage packet; this is a problem if the default network owner also happens to be the
rigidbody owner, because the damage packets will often be received at the same time as the confirmations of changes in health. This has not been solved in a sane way.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bullet-hits-do-not-transfer-ownership">Bullet hits do not transfer ownership<a href="#bullet-hits-do-not-transfer-ownership" class="hash-link" aria-label="Direct link to Bullet hits do not transfer ownership" title="Direct link to Bullet hits do not transfer ownership">​</a></h2>
<div><p><span><div class="hai_tag_ZcC4 hai_tag_requires_vrchat_kYpu">💬 <!-- -->VRChat</div></span></p></div>
<p>If a player shoots at a movable object, that object should be pushed away a little.</p>
<p>When two or more players shoot at the same object simultaneously, we want to avoid intensive ownership transfers.</p>
<p>For this reason, when a player shoots an object, that player transmits a specialized packet in the same way as described in the previous section using Player Objects.
This packet describes where the bullet was shot from, what was the direction of that bullet, and where the bullet hit in the local space of that object.</p>
<p>When that packet is received by the owner of the rigidbody, it reapplies the force of that bullet onto the object.
This allows the object to be pushed away a little by both players, without ownership transfers, although there is a visible delay from the shooter&#x27;s perspective.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lookup-tables">Lookup tables<a href="#lookup-tables" class="hash-link" aria-label="Direct link to Lookup tables" title="Direct link to Lookup tables">​</a></h2>
<p>In order to do this project, I ended up having a bunch of lookup tables which are baked in Edit mode:</p>
<ul>
<li>When a bullet hits a collider, the decals needs to stick to the visual representation of that collider, even if it&#x27;s a moving object.<!-- -->
<ul>
<li>Moving objects are not necessarily object-synced. For instance, doors are networked, but the rigidbody of the door is not itself a networked object,
so <strong>even some non-networked objects need to have a way to identify them</strong>.</li>
<li>Therefore, I associated a numerical identifier to every object that may need one, creating a parallel Network ID of some sorts.</li>
</ul>
</li>
<li>If an object can be damaged, then we need to identify this object for transmission of damage packets, so that damage effects can be applied back on every client.</li>
<li>When a collider is hit for any reason, we need to produce a sound effect, so each collider is associated with a collision sound effect identifier
based on either its Physics Material or the materials of the renderer; or multiple ones if there are sub-meshes, so the triangle index lookup table is part of that too.</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#continuous-speculative-outputs-0-newton-collisions" class="table-of-contents__link toc-highlight">Continuous Speculative outputs 0 newton collisions</a></li><li><a href="#if-a-thrown-object-breaks-another-open-it-should-not-bounce-away" class="table-of-contents__link toc-highlight">If a thrown object breaks another open, it should not bounce away</a></li><li><a href="#getting-the-material-hit-in-a-multi-material-mesh" class="table-of-contents__link toc-highlight">Getting the material hit in a multi-material mesh</a></li><li><a href="#manual-sync-arrives-way-sooner-than-ikvrcobjectsync" class="table-of-contents__link toc-highlight">Manual Sync arrives way sooner than IK/VRCObjectSync</a><ul><li><a href="#using-player-pools-to-send-and-receive-packets-player-objects" class="table-of-contents__link toc-highlight">Using Player pools to send and receive packets (Player Objects)</a></li><li><a href="#damage-packets-arrive-too-soon-before-the-visual-cause-of-damage-happens" class="table-of-contents__link toc-highlight">Damage packets arrive too soon, before the visual cause of damage happens</a></li><li><a href="#breaking-objects-from-collisions-are-intentionally-delayed" class="table-of-contents__link toc-highlight">Breaking objects from collisions are intentionally delayed</a></li></ul></li><li><a href="#bullet-hits-do-not-transfer-ownership" class="table-of-contents__link toc-highlight">Bullet hits do not transfer ownership</a></li><li><a href="#lookup-tables" class="table-of-contents__link toc-highlight">Lookup tables</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="centerline_SA5j" data-theme="dark"><p>Thank you to all of my supporters on Patreon ⭐</p><div class="card element_KzhA sp_qcMM k10_P0Dq ias_qO18 spias_HNS1">☀️ <!-- -->orels1</div>
<div class="card element_KzhA sp_qcMM k5_NYOb ias_qO18 spias_HNS1">🌟 <!-- -->bd_</div>
<div class="card element_KzhA sp_qcMM k3_DDJv ias_qO18 spias_HNS1">⭐ <!-- -->Vianvolaeus</div>
<div class="card element_KzhA sp_qcMM k3_DDJv ias_qO18 spias_HNS1">⭐ <!-- -->Nayir</div>
<div class="card element_KzhA sp_qcMM k3_DDJv ias_qO18 spias_HNS1">⭐ <!-- -->Cucumberworks</div>
<div class="card element_KzhA sp_qcMM k3_DDJv ias_qO18 spias_HNS1">⭐ <!-- -->Tupper</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Lyuma</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->kazu0617</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->it&#x27;s moe</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Duinrahaic</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->kittyn vr</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->PastelPlushies</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->SuikaNishi</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Jo Jo</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Nyashks</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Lavy</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->すいせい</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Tsu</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Xano</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->pager</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->poiyomi</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->DrJMAD</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Yeshou</div>
<div class="card element_KzhA sp_qcMM k2_SBmZ ias_qO18 spias_HNS1">⭐ <!-- -->Deathclaw_Gator</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->Lily</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->Lonerozu</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->Konro</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->FastWhippet</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->Quacky LaQuack</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->案内士 乗り換え</div>
<div class="card element_KzhA k2_SBmZ ias_qO18">⭐ <!-- -->Vamprigamer</div><div class="card element_KzhA andmore_P3Ch">⭐ <strong>595</strong> total <strong><a href="/docs/other/supporters" class="footerlink_XfCe">Patreon Supporters ...</a></strong></div><p><em>2024-12-16 Note: the extended list of longtime patrons in the footer is temporally disabled due to an issue on mobile browsers.</em></p></div><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a href="https://www.patreon.com/vr_hai" target="_blank" rel="noopener noreferrer" class="footer__link-item">Patreon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a href="https://hai-vr.fanbox.cc/" target="_blank" rel="noopener noreferrer" class="footer__link-item">pixivFANBOX<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a href="https://twitter.com/vr_hai" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a href="https://bsky.app/profile/just.hai-vr.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bluesky @just.hai-vr.dev<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/docs/other/discord">Discord</a><span class="footer__link-separator">·</span><a href="https://github.com/hai-vr/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a class="footer__link-item" href="/links">Links</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Invitational Software. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>